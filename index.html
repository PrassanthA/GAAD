<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Color Ball Game</title>
<style>
body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 0;
  background: #f5f5f5;
  min-height: 100vh;
}
.header-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px 0 8px;
  width: 100%;
  box-sizing: border-box;
  height: 130px; /* Increase header height to fit larger logos */
  overflow: hidden;
}
.logo {
  height: 160px;   /* Increase logo size */
  width: 160px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.logo img {
  height: 100%;
  width: 100%;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  display: block;
}
.menu-bar {
  text-align: center;
  margin: 24px auto 24px auto;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 4px 24px #0001;
  padding: 18px 0 10px 0;
  max-width: 540px;
  display: flex;
  justify-content: center;
  gap: 18px;
}
.menu-bar button {
  font-size: 1.15rem;
  margin: 0 8px;
  padding: 12px 32px;
  border-radius: 8px;
  border: none;
  background: #1976d2;
  color: #fff;
  cursor: pointer;
  transition: background 0.2s, transform 0.15s;
  font-weight: 600;
  letter-spacing: 0.5px;
  box-shadow: 0 2px 8px #0001;
}
.menu-bar button:hover,
.menu-bar button.active {
  background: #388e3c;
  transform: translateY(-2px) scale(1.04);
}
h1 {
  font-size: 2.7rem;
  color: #1976d2;
  margin-bottom: 10px;
  text-align: center;
  margin-top: 0;
  letter-spacing: 1px;
  font-weight: 800;
  text-shadow: 0 2px 8px #0001;
}
.intro {
  font-size: 1.18rem;
  color: #333;
  text-align: center;
  margin-bottom: 32px;
  max-width: 900px;
  margin-left: auto;
  margin-right: auto;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 2px 16px #0001;
  padding: 22px 32px;
  line-height: 1.6;
}
.game-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 80%;
  margin: 0 auto;
}
.color-balls {
  display: flex;
  flex-direction: column;
  margin-bottom: 30px;
}
.row {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 15px;
}
.ball {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  margin: 5px;
  cursor: pointer;
  transition: transform 0.2s cubic-bezier(.4,2,.6,1), box-shadow 0.2s, background 0.2s;
  background:
    radial-gradient(circle at 30% 30%, #fff9 0%, #fff0 60%),
    radial-gradient(circle at 70% 75%, #0003 0%, #0000 70%),
    linear-gradient(145deg, #fff4 0%, #0002 100%);
  box-shadow:
    0 8px 24px 0 rgba(0,0,0,0.28),
    0 2px 8px 0 rgba(0,0,0,0.18) inset,
    0 0.5px 1.5px 0 rgba(0,0,0,0.10) inset;
  position: relative;
  z-index: 1;
}
.ball:hover {
  transform: scale(1.12) translateY(-6px) rotateZ(-2deg);
  box-shadow:
    0 16px 32px 0 rgba(0,0,0,0.36),
    0 4px 12px 0 rgba(0,0,0,0.22) inset;
}
.ball.grey-scale {
  filter: grayscale(100%);
}
.color-boards {
  display: flex;
  justify-content: center;
  margin-bottom: 30px;
  width: 70%;
  flex-wrap: wrap;
}
.board {
  width: 100px;
  height: 100px;
  border: 3px solid #000;
  margin: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-align: center;
  font-weight: bold;
  color: white;
  font-size: 1rem;
  border-radius: 10px;
  cursor: pointer;
  transition: transform 0.2s ease;
}
.board[data-color="red"] { background-color: red; }
.board[data-color="blue"] { background-color: blue; }
.board[data-color="green"] { background-color: green; }
.board[data-color="yellow"] { background-color: yellow; color: #000;}
.board[data-color="purple"] { background-color: purple; }
.board:hover {
  transform: scale(1.1);
}
.board.highlight {
  box-shadow: 0 0 24px 8px #fff8, 0 0 0 4px #2224;
  transform: scale(1.08);
  border-color: #fff;
  transition: box-shadow 0.2s, border-color 0.2s, transform 0.2s;
}
.scoreboard {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 200px;
  padding: 20px;
  background-color: #2f4f4f;
  color: white;
  border-radius: 10px;
  font-size: 1.2rem;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  margin-bottom: 10px;
}
.scoreboard div {
  margin-bottom: 10px;
  font-weight: bold;
}
.scoreboard div span {
  font-size: 1.4rem;
}
button {
  padding: 12px 25px;
  font-size: 1rem;
  margin: 10px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s;
}
button:hover {
  background-color: #45a049;
}
.grey-scale {
  filter: grayscale(100%);
}

/* Accessibility Demo Styles */
.accessibility-demo .contrast-btn {
  font-size: 1.2rem;
  padding: 16px 32px;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  transition: filter 0.2s, background 0.2s, color 0.2s;
  outline: none;
  box-shadow: 0 2px 8px #0002;
  cursor: pointer;
}
.accessibility-demo .contrast-btn:active {
  transform: scale(0.97);
}
.accessibility-demo.greyscale .contrast-btn {
  filter: grayscale(100%);
}
.accessibility-demo.accessible .gaad-btn,
.accessibility-demo.accessible .good-btn,
.accessibility-demo.accessible .gost-btn {
  background: #222;
  color: #fff;
}
.accessibility-demo.accessible .gaad-btn { background: #fff; color: #222; border: 2px solid #222; }
.accessibility-demo.accessible .good-btn { background: #1976D2; color: #fff; }
.accessibility-demo.accessible .gost-btn { background: #388E3C; color: #fff; }
.accessibility-demo.greyscale .input-feedback {
  filter: grayscale(100%);
}
.highlight-input {
  padding: 14px 18px;
  border-radius: 8px;
  font-weight: bold;
  font-size: 1.1rem;
  min-width: 220px;
  border: 2.5px solid transparent;
  outline: none;
  transition: filter 0.2s, border-color 0.2s, background 0.2s, color 0.2s;
  margin: 0 4px;
  box-shadow: 0 2px 8px #0002;
}
.success-input {
  border-color: #388E3C;
  background: #e8f5e9;
  color: #222;
}
.error-input {
  border-color: #D32F2F;
  background: #ffebee;
  color: #222;
}
.accessibility-demo.greyscale .highlight-input {
  filter: grayscale(100%);
}
</style>
</head>
<body>
<!-- Header with logos -->
<div class="header-bar">
  <div class="logo" id="logo-left">
    
    <img src="vm_logo.png" alt="Virgin Money Logo">
</div>
<!-- Right logo -->
<div class="logo" id="logo-right">
  <img src="cog_logo.png" alt="Cognizant Logo">
</div>
</div>

<!-- Menu -->
<div class="menu-bar">
  <button id="showColorQuestBtn" class="active">Monochromacy Simulation</button>
  <button id="showAccessibilityBtn"> Monochromacy Accessibility Demo</button>
</div>

<!-- Main Heading and Intro -->
<h1>Monochromacy Simulation</h1>
<div class="intro">
  This interactive game helps you understand the importance of color and accessibility in design. Drag and drop colored balls into their matching boxes, and try the greyscale mode to experience how users with monochromacy perceive your choices. Explore the Monochromacy Accessibility Color Demo to learn about good and bad color contrast for everyone.
</div>

<!-- Color Quest Section -->
<div id="colorQuestSection">
  <div class="game-container">
    <!-- Color Balls -->
    <div class="color-balls">
      <div class="row">
        <div class="ball" draggable="true" id="ball1"></div>
        <div class="ball" draggable="true" id="ball2"></div>
        <div class="ball" draggable="true" id="ball3"></div>
        <div class="ball" draggable="true" id="ball4"></div>
        <div class="ball" draggable="true" id="ball5"></div>
        <div class="ball" draggable="true" id="ball6"></div>
        <div class="ball" draggable="true" id="ball7"></div>
        <div class="ball" draggable="true" id="ball8"></div>
        <div class="ball" draggable="true" id="ball9"></div>
        <div class="ball" draggable="true" id="ball10"></div>
        <div class="ball" draggable="true" id="ball11"></div>
        <div class="ball" draggable="true" id="ball12"></div>
        <div class="ball" draggable="true" id="ball13"></div>
        <div class="ball" draggable="true" id="ball14"></div>
        <div class="ball" draggable="true" id="ball15"></div>
      </div>
      <div class="row">
        <div class="ball" draggable="true" id="ball16"></div>
        <div class="ball" draggable="true" id="ball17"></div>
        <div class="ball" draggable="true" id="ball18"></div>
        <div class="ball" draggable="true" id="ball19"></div>
        <div class="ball" draggable="true" id="ball20"></div>
        <div class="ball" draggable="true" id="ball21"></div>
        <div class="ball" draggable="true" id="ball22"></div>
        <div class="ball" draggable="true" id="ball23"></div>
        <div class="ball" draggable="true" id="ball24"></div>
        <div class="ball" draggable="true" id="ball25"></div>
        <div class="ball" draggable="true" id="ball26"></div>
        <div class="ball" draggable="true" id="ball27"></div>
        <div class="ball" draggable="true" id="ball28"></div>
        <div class="ball" draggable="true" id="ball29"></div>
        <div class="ball" draggable="true" id="ball30"></div>
      </div>
      <div class="row">
        <div class="ball" draggable="true" id="ball31"></div>
        <div class="ball" draggable="true" id="ball32"></div>
        <div class="ball" draggable="true" id="ball33"></div>
        <div class="ball" draggable="true" id="ball34"></div>
        <div class="ball" draggable="true" id="ball35"></div>
        <div class="ball" draggable="true" id="ball36"></div>
        <div class="ball" draggable="true" id="ball37"></div>
        <div class="ball" draggable="true" id="ball38"></div>
        <div class="ball" draggable="true" id="ball39"></div>
        <div class="ball" draggable="true" id="ball40"></div>
        <div class="ball" draggable="true" id="ball41"></div>
        <div class="ball" draggable="true" id="ball42"></div>
        <div class="ball" draggable="true" id="ball43"></div>
        <div class="ball" draggable="true" id="ball44"></div>
        <div class="ball" draggable="true" id="ball45"></div>
      </div>
    </div>
    <!-- Color Boxes and Scoreboard Below -->
    <div class="color-boards">
      <div class="board" id="board1" data-color="red"><span>Red</span></div>
      <div class="board" id="board2" data-color="blue"><span>Blue</span></div>
      <div class="board" id="board3" data-color="green"><span>Green</span></div>
      <div class="board" id="board4" data-color="yellow"><span>Yellow</span></div>
      <div class="board" id="board5" data-color="purple"><span>Purple</span></div>
    </div>
    <div class="scoreboard">
      <div id="correct">Correct: <span>0</span></div>
      <div id="incorrect">Incorrect: <span>0</span></div>
    </div>
    <button id="shuffleBtn">Shuffle</button>
    <button id="greyscaleBtn">Greyscale</button>
  </div>
</div>

<!-- Accessibility Demo Section (initially hidden) -->
<div id="accessibilitySection" style="display:none;">
  <div class="accessibility-demo" style="margin-top:40px; text-align:center;">
    <h2>Accessibility Color Demo</h2>
    <div id="accessInstruction" style="font-size:1.2rem; margin-bottom:12px; font-weight:bold;"></div>
   <div id="accessButtons" style="display:flex; gap:20px; justify-content:center; margin-bottom:16px;">
  <button class="contrast-btn gaad-btn">GAAD</button>
  <button class="contrast-btn good-btn">GOOD</button>
  <button class="contrast-btn gost-btn">GOLD</button>
</div>
<div style="display: flex; gap: 18px; justify-content: center; margin-bottom: 18px;">
  <div style="display:flex; flex-direction:column; align-items:center;">
    <input type="text" class="highlight-input success-input" placeholder="input 1 (type here)">
    <span class="input-feedback success-feedback" style="display:none; color:#388E3C; font-size:1.05rem; margin-top:4px;">
      <span style="font-size:1.3em;">&#10003;</span> Your input is correct
    </span>
  </div>
  <div style="display:flex; flex-direction:column; align-items:center;">
    <input type="text" class="highlight-input error-input" placeholder="input 2 (type here)">
    <span class="input-feedback error-feedback" style="display:none; color:#D32F2F; font-size:1.05rem; margin-top:4px;">
      <span style="font-size:1.3em;">&#10007;</span> Your input is incorrect
    </span>
  </div>
</div>

    <button id="accessGreyscaleBtn" style="margin:0 8px;">Toggle Greyscale</button>
    <button id="accessibilityToggleBtn" style="margin:0 8px;">Show Accessible Options</button>
    <div style="font-size:0.95rem; color:#444; margin-top:10px;">
      Try toggling greyscale and check which is accessible.<br>
      Accessible color combinations are important for everyone and Color should not be the only way to convey information.
    </div>
    <div class="scoreboard" style="margin: 18px auto 0; width: 220px; display:none;">
      <div id="accessCorrect">Correct: <span>0</span></div>
      <div id="accessIncorrect">Incorrect: <span>0</span></div>
    </div>
    <div style="margin: 32px auto 0; max-width: 600px;">
  <h2 style="font-size:1.3rem; margin-bottom:1rem;">Color Blindness Category and how they will perceive colours</h2>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #FF0000; width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Normal Vision</span>: True red (#FF0000)</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #FF0000; filter: url(#protanopia); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Protanopia</span>: No red cones</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #FF0000; filter: url(#protanomaly); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Protanomaly</span>: Weak red perception</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #00FF00; filter: url(#deuteranopia); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Deuteranopia</span>: No green cones</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #00FF00; filter: url(#deuteranomaly); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Deuteranomaly</span>: Weak green perception</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #0000FF; filter: url(#tritanopia); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Tritanopia</span>: No blue cones</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #0000FF; filter: url(#tritanomaly); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Tritanomaly</span>: Weak blue perception</span>
  </div>
  <div class="type" style="display:flex;align-items:center;margin-bottom:12px;">
    <div class="box" style="background-color: #FF00FF; filter: url(#monochromacy); width:60px;height:30px;margin-right:10px;border:1px solid #ccc;"></div>
    <span><span class="label" style="font-weight:bold;">Monochromacy</span>: No color, grayscale vision</span>
  </div>
  <!-- SVG Filters -->
  <svg width="0" height="0">
    <defs>
      <filter id="protanopia">
        <feColorMatrix type="matrix" values="0.567,0.433,0,0,0 0.558,0.442,0,0,0 0,0.242,0.758,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="protanomaly">
        <feColorMatrix type="matrix" values="0.817,0.183,0,0,0 0.333,0.667,0,0,0 0,0.125,0.875,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="deuteranopia">
        <feColorMatrix type="matrix" values="0.625,0.375,0,0,0 0.7,0.3,0,0,0 0,0.3,0.7,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="deuteranomaly">
        <feColorMatrix type="matrix" values="0.8,0.2,0,0,0 0.258,0.742,0,0,0 0,0.142,0.858,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="tritanopia">
        <feColorMatrix type="matrix" values="0.95,0.05,0,0,0 0,0.433,0.567,0,0 0,0.475,0.525,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="tritanomaly">
        <feColorMatrix type="matrix" values="0.967,0.033,0,0,0 0,0.733,0.267,0,0 0,0.183,0.817,0,0 0,0,0,1,0"/>
      </filter>
      <filter id="monochromacy">
        <feColorMatrix type="matrix" values="0.299,0.587,0.114,0,0 0.299,0.587,0.114,0,0 0.299,0.587,0.114,0,0 0,0,0,1,0"/>
      </filter>
    </defs>
  </svg>
</div>
  </div>
</div>

<script>
// Menu logic
const colorQuestSection = document.getElementById('colorQuestSection');
const accessibilitySection = document.getElementById('accessibilitySection');
const showColorQuestBtn = document.getElementById('showColorQuestBtn');
const showAccessibilityBtn = document.getElementById('showAccessibilityBtn');

showColorQuestBtn.onclick = function() {
  colorQuestSection.style.display = '';
  accessibilitySection.style.display = 'none';
  showColorQuestBtn.classList.add('active');
  showAccessibilityBtn.classList.remove('active');
};
showAccessibilityBtn.onclick = function() {
  colorQuestSection.style.display = 'none';
  accessibilitySection.style.display = '';
  showAccessibilityBtn.classList.add('active');
  showColorQuestBtn.classList.remove('active');
};

// Color Quest Game Logic
let colorBalls = [
  { id: 'ball1', color: 'red' }, { id: 'ball2', color: 'blue' }, { id: 'ball3', color: 'green' },
  { id: 'ball4', color: 'yellow' }, { id: 'ball5', color: 'purple' }, { id: 'ball6', color: 'red' },
  { id: 'ball7', color: 'blue' }, { id: 'ball8', color: 'green' }, { id: 'ball9', color: 'yellow' },
  { id: 'ball10', color: 'purple' }, { id: 'ball11', color: 'red' }, { id: 'ball12', color: 'blue' },
  { id: 'ball13', color: 'green' }, { id: 'ball14', color: 'yellow' }, { id: 'ball15', color: 'purple' },
  { id: 'ball16', color: 'red' }, { id: 'ball17', color: 'blue' }, { id: 'ball18', color: 'green' },
  { id: 'ball19', color: 'yellow' }, { id: 'ball20', color: 'purple' }, { id: 'ball21', color: 'red' },
  { id: 'ball22', color: 'blue' }, { id: 'ball23', color: 'green' }, { id: 'ball24', color: 'yellow' },
  { id: 'ball25', color: 'purple' }, { id: 'ball26', color: 'red' }, { id: 'ball27', color: 'blue' },
  { id: 'ball28', color: 'green' }, { id: 'ball29', color: 'yellow' }, { id: 'ball30', color: 'purple' },
  { id: 'ball31', color: 'red' }, { id: 'ball32', color: 'blue' }, { id: 'ball33', color: 'green' },
  { id: 'ball34', color: 'yellow' }, { id: 'ball35', color: 'purple' }, { id: 'ball36', color: 'red' },
  { id: 'ball37', color: 'blue' }, { id: 'ball38', color: 'green' }, { id: 'ball39', color: 'yellow' },
  { id: 'ball40', color: 'purple' }, { id: 'ball41', color: 'red' }, { id: 'ball42', color: 'blue' },
  { id: 'ball43', color: 'green' }, { id: 'ball44', color: 'yellow' }, { id: 'ball45', color: 'purple' },
];
let colorBoards = document.querySelectorAll('.board');

colorBoards.forEach(board => {
  board.addEventListener('dragover', (e) => {
    e.preventDefault();
  });
});
colorBoards.forEach(board => {
  board.addEventListener('dragover', (e) => {
    e.preventDefault();
  });
  board.addEventListener('drop', (e) => {
    e.preventDefault();
    const ballId = e.dataTransfer.getData('ballId');
    const ballColor = e.dataTransfer.getData('ball');
    if (!ballId) return;
    const ballElement = document.getElementById(ballId);
    if (!ballElement) return;
    // Check color match
    if (ballColor === board.dataset.color) {
      document.querySelector('#correct span').textContent =
        parseInt(document.querySelector('#correct span').textContent) + 1;
      showPopup('Correct!', 'green');
    } else {
      document.querySelector('#incorrect span').textContent =
        parseInt(document.querySelector('#incorrect span').textContent) + 1;
      showPopup('Incorrect!', 'red');
    }
    resetBallPosition(ballElement);
  });
});

// Helper to reset ball to original position
function resetBallPosition(ballElement) {
  ballElement.style.transition = 'transform 0.4s';
  ballElement.style.transform = ballElement.dataset.origTransform || '';
  setTimeout(() => {
    ballElement.style.transition = '';
  }, 400);
}

// Helper to check proximity between ball and box
function isBallNearBox(ballElement, boxElement, threshold = 70) {
  const ballRect = ballElement.getBoundingClientRect();
  const boxRect = boxElement.getBoundingClientRect();
  const ballCenter = {
    x: ballRect.left + ballRect.width / 2,
    y: ballRect.top + ballRect.height / 2
  };
  const boxCenter = {
    x: boxRect.left + boxRect.width / 2,
    y: boxRect.top + boxRect.height / 2
  };
  const dx = ballCenter.x - boxCenter.x;
  const dy = ballCenter.y - boxCenter.y;
  const distance = Math.sqrt(dx * dx + dy * dy);
  return distance < threshold;
}

// Popup for feedback
function showPopup(msg, color) {
  const popup = document.getElementById('popup');
  popup.textContent = msg;
  popup.style.background = color === 'green' ? 'rgba(0,128,0,0.85)' : 'rgba(128,0,0,0.85)';
  popup.style.display = 'block';
  setTimeout(() => { popup.style.display = 'none'; }, 1200);
}

// Main logic for all balls
colorBalls.forEach(ball => {
  const ballElement = document.getElementById(ball.id);
  ballElement.style.backgroundColor = ball.color;

  // Store original position
  const rect = ballElement.getBoundingClientRect();
  ballElement.dataset.origLeft = rect.left;
  ballElement.dataset.origTop = rect.top;
  ballElement.dataset.origTransform = ballElement.style.transform || '';

  // Desktop drag-and-drop events
  ballElement.addEventListener('dragstart', (e) => {
    e.dataTransfer.setData('ball', ball.color);
    e.dataTransfer.setData('isGrey', ballElement.classList.contains('grey-scale'));
    e.dataTransfer.setData('ballId', ball.id);

    // Create a custom drag image
    const dragImage = ballElement.cloneNode(true);
    dragImage.style.position = 'absolute';
    dragImage.style.top = '-9999px';
    dragImage.style.left = '-9999px';
    if (ballElement.classList.contains('grey-scale')) {
      dragImage.style.filter = 'grayscale(100%)';
    }
    document.body.appendChild(dragImage);
    e.dataTransfer.setDragImage(dragImage, 30, 30);
    setTimeout(() => document.body.removeChild(dragImage), 0);
  });

  ballElement.addEventListener('dragend', () => {
    let matched = false;
    colorBoards.forEach(board => {
      if (isBallNearBox(ballElement, board)) {
        matched = true;
        if (ball.color === board.dataset.color) {
          document.querySelector('#correct span').textContent =
            parseInt(document.querySelector('#correct span').textContent) + 1;
          showPopup('Correct!', 'green');
        } else {
          document.querySelector('#incorrect span').textContent =
            parseInt(document.querySelector('#incorrect span').textContent) + 1;
          showPopup('Incorrect!', 'red');
        }
      }
    });
    resetBallPosition(ballElement);
  });

  // Touch events
  let startX, startY;
  ballElement.addEventListener('touchstart', (e) => {
    e.preventDefault();
    const touch = e.touches[0];
    startX = touch.clientX;
    startY = touch.clientY;
    ballElement.classList.add('dragging');
  });

  ballElement.addEventListener('touchmove', (e) => {
    e.preventDefault();
    const touch = e.touches[0];
    const deltaX = touch.clientX - startX;
    const deltaY = touch.clientY - startY;
    ballElement.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
  });

  ballElement.addEventListener('touchend', (e) => {
    e.preventDefault();
    ballElement.classList.remove('dragging');
    let matched = false;
    colorBoards.forEach(board => {
      if (isBallNearBox(ballElement, board)) {
        matched = true;
        if (ball.color === board.dataset.color) {
          document.querySelector('#correct span').textContent =
            parseInt(document.querySelector('#correct span').textContent) + 1;
          showPopup('Correct!', 'green');
        } else {
          document.querySelector('#incorrect span').textContent =
            parseInt(document.querySelector('#incorrect span').textContent) + 1;
          showPopup('Incorrect!', 'red');
        }
      }
    });
    resetBallPosition(ballElement);
  });
});

// Shuffle Button
document.getElementById('shuffleBtn').addEventListener('click', () => {
  colorBalls.forEach(ball => {
    const ballElement = document.getElementById(ball.id);
    ballElement.style.order = Math.floor(Math.random() * 45);
  });
});

// Greyscale button functionality
document.getElementById('greyscaleBtn').addEventListener('click', () => {
  document.querySelectorAll('.ball').forEach(ball => {
    ball.classList.toggle('grey-scale');
    if (ball.classList.contains('grey-scale')) {
      ball.style.filter = 'grayscale(100%)';
    } else {
      ball.style.filter = '';
    }
  });
  document.querySelectorAll('.board').forEach(board => {
    board.classList.toggle('grey-scale');
    if (board.classList.contains('grey-scale')) {
      board.style.filter = 'grayscale(100%)';
    } else {
      board.style.filter = '';
    }
  });
});

// Accessibility Demo Logic
const accessDemo = document.querySelector('.accessibility-demo');
const accessButtons = document.querySelectorAll('.accessibility-demo .contrast-btn');
const accessGreyscaleBtn = document.getElementById('accessGreyscaleBtn');
const accessibilityToggleBtn = document.getElementById('accessibilityToggleBtn');
const accessInstruction = document.getElementById('accessInstruction');
const accessCorrect = document.querySelector('#accessCorrect span');
const accessIncorrect = document.querySelector('#accessIncorrect span');
const buttonNames = ['GAAD', 'GOOD', 'GOLD'];
let accessGreyscale = false;
let accessibleMode = false;
let currentTarget = '';

function setRandomInstruction() {
  currentTarget = buttonNames[Math.floor(Math.random() * buttonNames.length)];
  accessInstruction.textContent = `Click on the "${currentTarget}" button`;
}
if (accessInstruction) setRandomInstruction();

function setBadContrast() {
  // All buttons: extremely poor contrast, hard to read in greyscale
  accessButtons[0].style.background = "#FFFF99"; // GAAD: yellow
  accessButtons[0].style.color = "#FFFACD";      // light yellow text

  accessButtons[1].style.background = "#FFD6E0"; // GOOD: light pink
  accessButtons[1].style.color = "#FFE0EF";      // almost same as background

  accessButtons[2].style.background = "#E0E0E0"; // GOST: light grey
  accessButtons[2].style.color = "#E8E8E8";      // just a bit lighter than background
}

function setAccessibleContrast() {
  // All buttons: accessible contrast, readable even in greyscale
  accessButtons[0].style.background = "#222";
  accessButtons[0].style.color = "#FFF";
  accessButtons[1].style.background = "#1976D2";
  accessButtons[1].style.color = "#FFF";
  accessButtons[2].style.background = "#388E3C";
  accessButtons[2].style.color = "#FFF";
}

accessButtons.forEach(btn => {
  btn.onclick = () => {
    if (btn.textContent === currentTarget) {
      accessCorrect.textContent = parseInt(accessCorrect.textContent) + 1;
    } else {
      accessIncorrect.textContent = parseInt(accessIncorrect.textContent) + 1;
    }
    shuffleAccessButtons();
    setRandomInstruction();
  };
});

accessGreyscaleBtn.onclick = () => {
  accessGreyscale = !accessGreyscale;
  accessDemo.classList.toggle('greyscale', accessGreyscale);
};

accessibilityToggleBtn.onclick = () => {
  accessibleMode = !accessibleMode;
  if (accessibleMode) {
    setAccessibleContrast();
    // Allow greyscale toggle in accessible mode
    // (do not disable the button)
  } else {
    setBadContrast();
    // If greyscale was on before, re-apply it
    if (accessGreyscale) {
      accessDemo.classList.add('greyscale');
    }
  }
};
accessibilityToggleBtn.onclick = () => {
  accessibleMode = !accessibleMode;
  if (accessibleMode) {
    setAccessibleContrast();
    // Show feedback below inputs
    document.querySelector('.success-feedback').style.display = 'inline-block';
    document.querySelector('.error-feedback').style.display = 'inline-block';
  } else {
    setBadContrast();
    // Hide feedback below inputs
    document.querySelector('.success-feedback').style.display = 'none';
    document.querySelector('.error-feedback').style.display = 'none';
    if (accessGreyscale) {
      accessDemo.classList.add('greyscale');
    }
  }
};
function shuffleAccessButtons() {
  const parent = document.getElementById('accessButtons');
  const btns = Array.from(accessButtons);
  // Shuffle array
  for (let i = btns.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [btns[i], btns[j]] = [btns[j], btns[i]];
  }
  // Remove all and re-append in new order
  btns.forEach(btn => parent.appendChild(btn));
}
function showPopup(msg, color) {
  const popup = document.getElementById('popup');
  popup.textContent = msg;
  popup.style.background = color === 'green' ? 'rgba(0,128,0,0.85)' : 'rgba(128,0,0,0.85)';
  popup.style.display = 'block';
  setTimeout(() => { popup.style.display = 'none'; }, 1200);
}
// Initialize with bad contrast
setBadContrast();
</script>
<div id="popup" style="display:none; position:fixed; bottom:40px; left:40px; text-align:left; font-size:2em; z-index:9999; color:#fff; pointer-events:none; min-width:180px; border-radius:10px; padding:10px 24px;"></div>
</body>
</html>